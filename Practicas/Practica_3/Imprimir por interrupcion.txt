ORG 1000H
 MENSAJE DB "HOLA"
 FIN DB ?
 
ORG 3000H
;RECORREMOS EL MENSAJE Y LO ENVIAMOS POR CARACTER
IMPRIMIR: PUSH AX
 MOV AL, [BX] 
 OUT 40H, AL
;AVISO AL PIC Y VUELVO
INC BX
DEC DL
JNZ CONTINUAR
;DESACTIVO HANDSHAKE POR INTERRUPCION
MOV AL, 01111111B
OUT 21H, AL
;___________________________________
CONTINUAR: MOV AL, 20H
OUT 20H, AL
POP AX
IRET

ORG 2000H
;CONFIGURO EL VECTOR DE INTERRUPCIONES. ID = 9
MOV AX, IMPRIMIR
MOV BX, 36       ;9*4 = 36
MOV [BX], AX
;CONTADOR
MOV DL, OFFSET FIN - OFFSET MENSAJE
;CONFIGURO PIC
CLI
MOV AL, 11111011B ;SOLO HANDSHAKE HABILITADO
OUT 21H, AL ;IRM
MOV AL, 9
OUT 26H, AL ;INT2
MOV BX, OFFSET MENSAJE

;CONFIGURO EL HANDSHAKE PARA LA INTERRUPCION
IN AL, 40H
OR AL, 10000000B
OUT 41H, AL
STI
;SIMULAMOS UN PROGRAMA EN EJECUCION

POLL: CMP BX, OFFSET FIN ;CHEQUEO QUE LLEGO AL FINAL
JNZ POLL

INT 0